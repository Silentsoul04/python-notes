# 配置数据库
> GitHub@[orca-j35](https://github.com/orca-j35)，所有笔记均托管于 [python_notes](https://github.com/orca-j35/python_notes) 仓库

关系型数据库使用表来存储数据，可分为以下几类:

- 商用数据库: 如 [Oracle](https://www.oracle.com/)，[SQL Server](https://www.microsoft.com/sql-server/)，[DB2](https://www.ibm.com/db2/)等
- 开源数据库: 如 [MySQL](https://www.mysql.com/)，[PostgreSQL](https://www.postgresql.org/)等
- 桌面数据库: 如微软 [Access](https://products.office.com/access)，适合桌面应用程序使用
- 嵌入式数据库: 如 [Sqlite](https://sqlite.org/)为代表，适合手机应用和桌面程序

非关系型数据库使用键值对的形式来存储数据(如，MongoDB、Redis)

## 数据库管理工具

可视化数据库管理工具:

- https://www.navicat.com.cn/

  破解参考 [1](https://github.com/Deltafox79/Navicat_Keygen) , [2](https://www.jianshu.com/p/5f693b4c9468?mType=Group)


## MySQL

相关资源:

- Home: https://www.mysql.com/cn/
- Download: https://dev.mysql.com/downloads/mysql/
  - For Windows: https://dev.mysql.com/downloads/windows/installer/8.0.html
- 教程 - 廖雪峰: https://www.liaoxuefeng.com/wiki/001508284671805d39d23243d884b8b99f440bfae87b0f4000
- 教程 - runoob: http://www.runoob.com/mysql/mysql-tutorial.html

MySQL 官方提供了以下几个版本的 MySQL 数据库:

- [MySQL Community Edition](https://www.mysql.com/products/community/): 社区开源版本(GPL)
- [MySQL Standard Edition](https://www.mysql.com/products/standard/): 标准版 (commercial)
- [MySQL Enterprise Edition](https://www.mysql.com/products/enterprise/): 企业版 (commercial)
- [MySQL Cluster Carrier Grade Edition](https://www.mysql.com/products/cluster/): 集群版 (commercial)

上述版本的功能和价格依次递增，但增加的功能主要是监控、集群等管理功能，各版本中基本的 SQL 功能是完全一样的。所以使用 MySQL 的好处是可以先利用社区版进行学习、开发、测试，需要部署的时候，可以选择付费的高级版本，或者云服务商提供的兼容版本，而不需要对应用程序本身做改动。

### Install on Windows

> 参考:
>
> - [安装MySQL - 廖雪峰](https://www.liaoxuefeng.com/wiki/001508284671805d39d23243d884b8b99f440bfae87b0f4000/00150916716600634d1020c90304a6aaa5f37248006f900000)
> - 《python3网络爬虫开发实战》-> MySQL 的安装

在 [MySQL Installer](https://dev.mysql.com/downloads/installer/) 中可获取 Windows 版本的 MySQL(如, `mysql-installer-community.msi`)。安装过程中始终选用默认配置即可，一路 next 便可完成安装。安装程序会自动在 Windows 中将 MySQL 设置为服务。在安装完成后，便可直接使用 MySQL 客户端连接 MySQL 服务器。

在安装过程中需记住以下配置，以便今后使用(可通过 MySQLInstaller.exe 修改这些配置):

- 默认端口: 3306
- root 密码: orca_j35
- Windows Service Name: MySQL80

在 "计算机管理"->"服务和应用程序"->"服务" 中可查看 MySQL 服务(名称是 MySQL80)是否启动。可以在"服务"中关闭 MySQL 服务，或禁止其自动启动。

### 管理工具

以下是适用于 MySQL 的可视化管理工具:

- [MySQL Workbench](https://dev.mysql.com/downloads/workbench/) - 在 MySQL 安装包中自带该工具
- [MySQL-Front](http://www.mysqlfront.de/) - 用于MySQL数据库服务器的 Windows 前端程序。在连接本地 MySQL 数据库时，需将主机设置为 `localhost` 或 `127.0.0.1`

### Python Drivers

#### Connector/Python

相关资源:

- [MySQL Connector/Python Developer Guide](https://dev.mysql.com/doc/connector-python/en/)
- [MySQL Connector/Python X DevAPI Reference Documentation](https://dev.mysql.com/doc/dev/connector-python/8.0/)
- [Download Connector/Python](https://dev.mysql.com/downloads/connector/python/)
- GitHub: https://github.com/mysql/mysql-connector-python
- PyPI: https://pypi.org/project/mysql-connector-python

推荐使用 `pip` (或 `conda` )安装 Connector/Python

```shell
conda install mysql-connector-python
```

下面的代码用于测试连接器是否安装成功:

```python
# 需保持mysql服务开启
import mysql.connector
cnx = mysql.connector.connect(user='scott', password='password',
                              host='127.0.0.1',
                              database='employees')
cnx.close()
```

在 Windows 中还可使用 [MySQL Installer](https://dev.mysql.com/downloads/windows/installer/8.0.html)(或[独立的 MSI Installer](https://dev.mysql.com/downloads/connector/python/))来安装 Connector/Python。Installer 会检查本机中 Python 的路径，并将 Connector/Python 置于 `~\PythonX.Y\Lib\site-packages\` 中。不推荐使用这种方式安装，因为这会导致 `pip` (或 `conda` )无法管理此包。

#### PyMySQL

相关资源:

- GitHub: https://github.com/PyMySQL/PyMySQL/
- PyPI: https://pypi.org/project/PyMySQL/
- Docs: https://pymysql.readthedocs.io/en/latest/

```shell
python3 -m pip install PyMySQL
conda install pymysql
```

下面的代码用于测试是否安装成功:

```python
import pymysql
print(pymysql.VERSION)
```



## MongoDB

MongoDB 是由 C++ 编写的 NoSQL 开源数据库，其内容的存储形式类似于 JSON，其字段中可包含其它文档、数组及文档数组，非常灵活。

相关资源:

- Home: https://www.mongodb.com/
- GitHub: https://github.com/mongodb
- StackOverflow: https://stackoverflow.com/tags/mongodb/info?jmp=footer
- Download: https://www.mongodb.com/download-center/community
- Docs: https://docs.mongodb.com/
- 教程 - runoob: http://www.runoob.com/mongodb/mongodb-tutorial.html

### Install on Windows

MongoDB 官方在 [Install MongoDB Community Edition on Windows](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-windows/) 中给出了详细的安装指导，遵循此文档即可顺利完成安装。

安装器(`.msi`)会同时安装 MongoDB 的二进制文件和默认[配置文件](https://docs.mongodb.com/manual/reference/configuration-options/)( `<install directory>\bin\mongod.cfg` )。

从 MongoDB 4.0 开始，如果在安装器中选择 "Complete" 安装选项，便可在安装过程中将 MongoDB 设置为服务(免去了手动设置的麻烦)，此时也可以只安装二进制文件。如果只安装了二进制文件或是选择 "Custom" 安装选项，则需手动配置 MongoDB 服务，具体配置过程可参考如下资料:

- http://www.runoob.com/mongodb/mongodb-window-install.html
- 《python3网络爬虫开发实战》-> MongDB 的安装
- 崔庆才_Python3爬虫视频 -> 课时02：MongoDB环境配置.mp4

### 命令行程序

简要介绍一下 `<install directory>\bin` 中的文件:

- mongod.exe: 用于建立 MongoDB 服务器
- mongo.exe: 交互式的 JavaScript shell 用于连接 MongoDB 服务器
- mongod.cfg: 配置文件，可查看各种配置信息(如, 端口、IP 地址、数据库路径、日志路径等)

### 管理工具

以下是适用于 MongoDB  的可视化管理工具:

- [Robo 3T](https://robomongo.org/): 十分轻便的管理工具
- [Studio 3T](https://studio3t.com): 比 Robo 3T 功能更加丰富
- [MongoDB Compass](https://www.mongodb.com/products/compass): MongoDB 官方提供的可视化管理工具

### Python Drivers

相关资源:

- [Python MongoDB Drivers](https://docs.mongodb.com/ecosystem/drivers/python/)
- [MongoDB Drivers and ODM](https://docs.mongodb.com/ecosystem/drivers/)
- [Getting Started](https://docs.mongodb.com/manual/tutorial/getting-started/)

#### PyMongo

Mongo 官方推荐将 PyMongo 用作 MongoDB 的驱动

相关资源:

- GitHub: https://github.com/mongodb/mongo-python-driver
- PyPI: https://pypi.org/project/pymongo/
- [PyMongo 3.7.2 Documentation](http://api.mongodb.com/python/current/index.html)
- [PyMongo 3.7.2 Tutorial](http://api.mongodb.com/python/current/tutorial.html)
- [API Documentation](http://api.mongodb.com/python/current/api/index.html)
- [Python Driver](https://docs.mongodb.com/ecosystem/drivers/python/#python-driver)

```shell
python -m pip install pymongo
conda install pymongo
```

下面的代码用于测试是否安装成功:

```python
import pymongo
print(pymongo.version)
```

#### Motor

推荐将 Motor 用作 MongoDB 的异步驱动。Motor 兼容 [Tornado](http://www.tornadoweb.org/) 和 [asyncio](https://docs.python.org/3/library/asyncio.html)，但不支持 Windows。

相关资源:

- GitHub: https://github.com/mongodb/motor/
- Docs: https://motor.readthedocs.io/en/stable/
- [Async Driver](https://docs.mongodb.com/ecosystem/drivers/python/#async-driver)

## Redis

Redis 是面向 key-value 型数据的高性能存储系统。因为值(*value*)可以是字符串(*String*), 哈希(*Map*), 列表(*list*), 集合(*sets*), 有序集合(*sorted sets)*和位图(*bitmaps*)等类型，所以又被称为数据结构服务器。Redis 最好的地方便是用于提供数据持久化功能(定时把内存中的数据写入文件)，从而不至于一旦宕机将造成数据丢失。而且相较于 Memcached ，它提供的值类型选择更为宽泛。

相关资源:

- Home: https://redis.io
- Home-CN: http://www.redis.cn
- GitHub: https://github.com/antirez/redis
- Docs: https://redis.io/documentation
- 在线互动教程: http://try.redis.io/
- 教程 - runoob: http://www.runoob.com/redis/redis-tutorial.html
- [Windows 上的 Redis 的缺点](https://redislabs.com/ebook/appendix-a/a-3-installing-on-windows/a-3-1-drawbacks-of-redis-on-windows/)

### Install on Windows

相关资源:

- Microsoft's native port of Redis: https://github.com/MicrosoftArchive/redis
- 在 Windows 中安装 Redis 的三种方法(https://github.com/ServiceStack/redis-windows)
  - Install Redis on Ubuntu on Windows, Use [Windows Subsystem for Linux (WSL)](https://msdn.microsoft.com/en-us/commandline/wsl/install_guide)
  - Running the latest version of Redis with Vagrant
  - Running Microsoft's native port of Redis
- [How do I run Redis on Windows? - stackoverflow](https://stackoverflow.com/questions/6476945/how-do-i-run-redis-on-windows/10525215)

在 [MicrosoftArchive/redis](https://github.com/MicrosoftArchive/redis) 中提供了适用于 Windows 的安装包(如, [Redis-x64-3.2.100.msi](https://github.com/MicrosoftArchive/redis/releases/download/win-3.2.100/Redis-x64-3.2.100.msi))，但微软提供的版本远低于 Redis 官方释放的版本，比如目前微软的版本是 3.2，而 Redis 官方的版本是 5.0。

安装过程中始终选用默认配置即可，一路 next 便可完成安装。安装程序会自动在 Windows 中将 Redis 设置为服务。在安装完成后，便可直接使用 Redis 客户端连接 Redis 服务器。

如果不想通过安装器 [Redis-x64-3.2.100.msi](https://github.com/MicrosoftArchive/redis/releases/download/win-3.2.100/Redis-x64-3.2.100.msi) 进行安装，而是想通过 [Redis-x64-3.2.100.zip](https://github.com/MicrosoftArchive/redis/releases/download/win-3.2.100/Redis-x64-3.2.100.zip) 手动配置，可参考下面的连接:

- http://www.runoob.com/redis/redis-install.html
- https://www.cnblogs.com/weiqinl/p/6490372.html
- https://www.cnblogs.com/sunxuchu/p/5463403.html
- https://www.cnblogs.com/panchunting/p/Redis_On_Windows_Install.html 包含源代码的编译方法

### 命令行程序

简要介绍一下 `<install directory>\Redis` 中的文件:

- redis-server.exe: 服务端程序

- redis-cli.exe: 客户端程序，用于连接服务端

- redis.conf: 配置文件

- redis-check-dump.exe: 本地数据库检查

- redis-check-aof.exe: 更新日志检查

- redis-benchmark.exe: 性能测试，用于模拟同时由 N 个客户端发送 M 个  SETs/GETs 查询，例如

  ```shell
  # 向redis服务器发送10万个请求，每个请求附带60个并发客户端
  redis-benchmark -n 100000 -c 60
  ```

### 管理工具

以下是适用于 MongoDB  的可视化管理工具:

- [Redis Desktop Manager](https://github.com/uglide/RedisDesktopManager/): 0.9.4 版本开始收费，官方不再提供下载，但是有第三方编译并提供了安装包，见 https://github.com/necan/RedisDesktopManager-Windows
  - Docs: http://docs.redisdesktop.com/en/latest/quick-start/
- [RedisStudio (Redis GUI Client)](https://github.com/cinience/RedisStudio): 无需安装，直接可用
- [Redis React](https://github.com/ServiceStackApps/RedisReact#download): Redis React is a simple user-friendly UI for browsing data in Redis servers. 无需安装，直接可用
- [redis-web-app](https://github.com/NetCoreWebApps/Redis): Redis Vue is a simple, lightweight, versatile Redis Admin UI developed using [Vue](https://vuejs.org/v2/guide/) and [ServiceStack .NET Core Web Apps](http://templates.servicestack.net/docs/web-apps). 

### Python Drivers

#### Redis-Py

在 Python 中可通过 redis-py 来操作 Redis 数据库。

相关资源:

- GitHub: https://github.com/andymccurdy/redis-py
- PyPI: https://pypi.org/project/redis/
- Docs: https://redis-py.readthedocs.io/en/latest/

```shell
pip install redis
conda install redis-py
```

在 conda 中需使用 `redis-py`，如果使用 `redis` 则会安装 redis 数据库。

下面的代码用于测试是否安装成功:

```python
import redis
print(redis.VERSION)
```

### Redis-Dump

Redis-Dump 由 Ruby 实现的用于导入导出 Redis 数据的工具。需要先安装 Ruby 才能使用 Redis-Dump。

Ruby 相关资源:

- Home: http://www.ruby-lang.org/zh_cn/
- RubyInstaller: https://rubyinstaller.org/
- RubyGems: https://rubygems.org/

Redis-Dump 相关资源:

- GitHub: https://github.com/delano/redis-dump
- Docs:
  - http://delanotes.com/redis-dump/
  - https://www.rubydoc.info/gems/redis-dump/0.4.0/file/README.rdoc  
- Gem: https://rubygems.org/gems/redis-dump

安装 Redis-Dump

```shell
$ gem install redis-dump
```

测试安装，尝试调用以下命令：

```shell
redis-dump
redis-load
```



